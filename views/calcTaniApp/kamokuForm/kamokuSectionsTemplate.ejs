<% //科目セクションをすべて描画する %>
<% for (let kamokuSection of kamokuSections) { %>
<%- include("./kamokuContentsTemplate", {section : kamokuSection}) %>
<% } %>

<script>
  //科目セクションの階層構造を作る
  const kamokuSectionElems = document.getElementsByClassName("kubun");
  const kamokuSectionsCopy = [];
  //そのままHTML要素を操作すると対象の順番が変化してしまうため
  //最初に取得した要素をそのまま操作できなくなる
  //そこで、取得した科目セクションのidをコピーする
  for (const kamokuSectionElem of kamokuSectionElems) {
    kamokuSectionsCopy.push(kamokuSectionElem.id);
  }
  // コピーした科目セクションのidをもとに取得した科目セクションをその親セクションに追加していく
  for (const kamokuSectionName of kamokuSectionsCopy) {
    const kamokuSection = document.getElementById(kamokuSectionName);
    let parent = document.getElementById(kamokuSection.dataset.belong);
    if (parent) { parent.appendChild(kamokuSection) }
  }
</script>